
<html><head><link rel="stylesheet" href="slurm-guide-styles.css"></head><body><h1 id="guide-to-using-slurm"> Slurm User Guide </h1>

<h2>  Using Conda in Slurm Jobs </h2>

Conda is a popular package management system and environment management system. When using Slurm on a cluster, you may need to activate and use Conda environments in your job scripts. Here's how to do it effectively:

<h3>  1. Loading Conda </h3>

<p>First, you need to ensure Conda is available in your Slurm job. This usually involves loading a module or sourcing a script to initialize Conda. The exact method can vary depending on your cluster's configuration. Common approaches include:
</p>

# Option 1: Loading a module
module load anaconda3



<h3>  2. Activating a Conda Environment</h3>

Once Conda is loaded, you can activate your environment. Here's how you might do this in a Slurm script:

<code>

<p>
#!/bin/bash <br>
#SBATCH --job-name=conda_job <br>
#SBATCH --output=output_%j.log<br>
#SBATCH --error=error_%j.log<br>
#SBATCH --time=01:00:00<br>
#SBATCH --ntasks=1<br>
#SBATCH --cpus-per-task=1<br>
#SBATCH --mem=4G<br>
<br>
# Load Conda<br>
module load anaconda3<br>
<br>
# Activate your environment<br>
conda activate myenv<br>
<br>
# Run your Python script<br>
python my_script.py<br>
</p>
</code>

<h3>  3. Creating Conda Environments on the Fly </h3>

Sometimes, you might want to create a Conda environment as part of your job. Here's an example:

<code>
#!/bin/bash<br>
#SBATCH --job-name=conda_create_job<br>
#SBATCH --output=output_%j.log<br>
#SBATCH --error=error_%j.log<br>
#SBATCH --time=01:00:00<br>
#SBATCH --ntasks=1<br>
#SBATCH --cpus-per-task=1<br>
#SBATCH --mem=4G<br>
<br>
# Load Conda<br>
module load anaconda3<br>
<br>
# Create a new environment<br>
conda create -n job_env python=3.8 numpy pandas -y<br>
<br>
# Activate the new environment<br>
conda activate job_env<br>
<br>
# Run your Python script<br>
python my_script.py<br>
<br>
# Optionally, remove the environment at the end of the job<br>
conda deactivate<br>
conda env remove -n job_env -y<br>
<br>
</code>

<h3>  4. Best Practices for Using Conda with Slurm </h3>

<li>Specify exact versions**: When creating environments, specify exact versions of packages to ensure reproducibility.</li>

<li>Use environment files**: For complex environments, use a `environment.yml` file to specify dependencies.</li>

<li>Clean up after your job**: If you create temporary environments, make sure to remove them to free up space.</li>


<h3>  6. Troubleshooting Conda in Slurm Jobs </h3>

If you encounter issues:

<li> Check your Slurm output and error logs for Conda-related errors.</li>
<li> Ensure Conda is properly initialized in your job script.</li>
<li>- Verify that the specified Conda environment exists and contains the necessary packages.</li>
<li>- Check for any conflicts between Conda and other modules loaded in your job.</li>

</body>
</html>